- name: Add label based on title
  uses: actions/github-script@v7
  with:
    github-token: ${{ secrets.GITHUB_TOKEN }}
    script: |
      // Make title lowercase for case-insensitive matching
      const title = github.context.payload.pull_request.title.toLowerCase()
      const pr_number = github.context.payload.pull_request.number
      let label = null

      // Define rules (case-insensitive because title is lowercased)
      if (title.includes('fix')) {
        label = 'patch'
      } else if (title.includes('add')) {
        label = 'minor'
      } else if (title.includes('breaking')) {
        label = 'major'
      }

      if (label) {
        await github.rest.issues.addLabels({
          owner: github.context.repo.owner,
          repo: github.context.repo.repo,
          issue_number: pr_number,
          labels: [label]
        })
        console.log(`Added label: ${label}`)
      } else {
        console.log('No label added')
      }